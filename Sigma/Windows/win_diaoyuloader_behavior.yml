title: Diaoyu Loader – Dynamically resolving Windows API.
name: Dynamically_resolving_Windows_API
id: 46b41a5d-28ed-4969-b74f-3c7e07dcc0fe
status: experimental
description: Detects Diaoyu Loader Dynamically resolving Windows API.
references:
        - https://attack.mitre.org/
        - https://unit42.paloaltonetworks.com/shadow-campaigns-uncovering-global-espionage/
author: Phatcharadol Thangplub
date: 2026-02-26
modified: 2026-02-26
tags:
        - attack.T1027.007
logsource:
        product: windows
        service: sysmon
detection:
        selection_loaded_image:
                EventID: 7
                ImageLoaded|endswith:
                        - "urlmon.dll"
        condition: selection_loaded_image
falsepositives:
        - Unknown
level: high
---
title: Diaoyu Loader – Download Cobalt Strike beacon.
name: Download_Cobalt_Strike_beacon
id: 68782286-e349-4a02-8d88-f4c9052f6fd2
status: experimental
description: Detects Diaoyu Loader Download Cobalt Strike beacon.
references:
        - https://attack.mitre.org/
        - https://unit42.paloaltonetworks.com/shadow-campaigns-uncovering-global-espionage/
author: Phatcharadol Thangplub
date: 2026-02-22
modified: 2026-02-26
tags:
        - attack.T1105
logsource:
        product: windows
        service: sysmon
detection:
        selection_dns_query:
                EventID: 22
                QueryName|startswith:
                        - "raw.githubusercontent.com"
        condition: selection_dns_query
falsepositives:
        - Unknown
level: high
---
title: Diaoyu Loader – Create Cobalt Strike beacon.
name: Create_Cobalt_Strike_beacon
id: c4f89e97-8b44-49c6-bb25-9beea66210a5
status: experimental
description: Detects Diaoyu Loader Create Cobalt Strike beacon.
references:
        - https://attack.mitre.org/
        - https://unit42.paloaltonetworks.com/shadow-campaigns-uncovering-global-espionage/
author: Phatcharadol Thangplub
date: 2026-02-22
modified: 2026-02-26
tags:
        - attack.T1105
logsource:
        product: windows
        service: sysmon
detection:
        selection_file_creation:
                EventID: 11
                TargetFilename|contains:
                        - "C:\\Users\\*\\Links\\*.docx"
                        - "C:\\Users\\*\\Videos\\*.exe"
                        - "C:\\Users\\*\\Videos\\*.dll"
        condition: selection_file_creation
falsepositives:
        - Unknown
level: high
---
title: Diaoyu Loader – Correlate Beacon Download and Creation.
id: 4e1e4519-4eed-4140-8edc-dc6923f11c10
correlation:
        type: temporal
        rules:
                - Dynamically_resolving_Windows_API
                - Download_Cobalt_Strike_beacon
                - Create_Cobalt_Strike_beacon
        group-by:
                - Computer
                - User
                - ProcessId
                - Image
        timespan: 1m